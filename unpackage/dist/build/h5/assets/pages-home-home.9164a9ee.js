import{r as e,o as t,c as s,w as i,a,F as o,b as r,d as n,n as l,e as d,t as c,i as h,f as u,g as m,h as g,O as f,j as p,k as _,l as b,m as w,p as v,q as k,s as y,u as C,v as I,x,y as B,S as D,z as q,A as H,B as j,C as S,D as $,E,G as F}from"./index-7933716b.js";import{_ as T}from"./_plugin-vue_export-helper.1b428a4d.js";const z=T({__name:"tab-control",props:{titles:{type:Array,default:()=>[]}},emits:["tab-item-click"],setup(m,{emit:g}){const f=e(0);return(e,p)=>{const _=h,b=u;return t(),s(b,{class:"tab-control"},{default:i((()=>[(t(!0),a(o,null,r(m.titles,((e,a)=>(t(),s(b,{key:a,class:"tab-item",onClick:e=>(e=>{f.value=e,g("tab-item-click",e)})(a)},{default:i((()=>[n(_,{class:l(["title",{active:a===f.value}])},{default:i((()=>[d(c(e),1)])),_:2},1032,["class"])])),_:2},1032,["onClick"])))),128))])),_:1})}}},[["__scopeId","data-v-439d6396"]]);function A(e,t){return _(e)?t:e}const G=e=>(t,s=g())=>{!b&&m(e,t,s)},L=G(f),M=G(p),N=T({__name:"grid-view-item",props:{goodsInfo:{type:Object,default:()=>{}}},setup:e=>(a,o)=>{const r=u,l=h,m=y,g=w("lazy");return t(),s(r,{class:"goods-item"},{default:i((()=>[v(k("img",{class:"image"},null,512),[[g,e.goodsInfo.show.img]]),n(r,{class:"desc-info"},{default:i((()=>[n(r,{class:"title"},{default:i((()=>[d(c(e.goodsInfo.title),1)])),_:1}),n(r,{class:"info"},{default:i((()=>[n(l,{class:"price"},{default:i((()=>[d("￥"+c(e.goodsInfo.price),1)])),_:1}),n(m,{class:"cfav-img",src:"/assets/favor-347be16f.png",mode:"widthFix"}),n(l,{class:"cfav"},{default:i((()=>[d(c(e.goodsInfo.cfav),1)])),_:1})])),_:1})])),_:1})])),_:1})}},[["__scopeId","data-v-37528baf"]]);const O=T({name:"UniGridItem",inject:["grid"],props:{index:{type:Number,default:0}},data:()=>({column:0,showBorder:!0,square:!0,highlight:!0,left:0,top:0,openNum:2,width:0,borderColor:"#e5e5e5"}),created(){this.column=this.grid.column,this.showBorder=this.grid.showBorder,this.square=this.grid.square,this.highlight=this.grid.highlight,this.top=0===this.hor?this.grid.hor:this.hor,this.left=0===this.ver?this.grid.ver:this.ver,this.borderColor=this.grid.borderColor,this.grid.children.push(this),this.width=this.grid.width},beforeDestroy(){this.grid.children.forEach(((e,t)=>{e===this&&this.grid.children.splice(t,1)}))},methods:{_onClick(){this.grid.change({detail:{index:this.index}})}}},[["render",function(e,a,o,r,d,c){const h=u;return d.width?(t(),s(h,{key:0,style:C("width:"+d.width+";"+(d.square?"height:"+d.width:"")),class:"uni-grid-item"},{default:i((()=>[n(h,{class:l([{"uni-grid-item--border":d.showBorder,"uni-grid-item--border-top":d.showBorder&&o.index<d.column,"uni-highlight":d.highlight},"uni-grid-item__box"]),style:C({"border-right-color":d.borderColor,"border-bottom-color":d.borderColor,"border-top-color":d.borderColor}),onClick:c._onClick},{default:i((()=>[I(e.$slots,"default",{},void 0,!0)])),_:3},8,["class","style","onClick"])])),_:3},8,["style"])):x("",!0)}],["__scopeId","data-v-0810a0ad"]]);const U=T({name:"UniGrid",emits:["change"],props:{column:{type:Number,default:3},showBorder:{type:Boolean,default:!0},borderColor:{type:String,default:"#D2D2D2"},square:{type:Boolean,default:!0},highlight:{type:Boolean,default:!0}},provide(){return{grid:this}},data:()=>({elId:`Uni_${Math.ceil(1e6*Math.random()).toString(36)}`,width:0}),created(){this.children=[]},mounted(){this.$nextTick((()=>{this.init()}))},methods:{init(){setTimeout((()=>{this._getSize((e=>{this.children.forEach(((t,s)=>{t.width=e}))}))}),50)},change(e){this.$emit("change",e)},_getSize(e){B().in(this).select(`#${this.elId}`).boundingClientRect().exec((t=>{this.width=parseInt((t[0].width-1)/this.column)+"px",e(this.width)}))}}},[["render",function(e,a,o,r,d,c){const h=u;return t(),s(h,{class:"uni-grid-wrap"},{default:i((()=>[n(h,{id:d.elId,ref:"uni-grid",class:l(["uni-grid",{"uni-grid--border":o.showBorder}]),style:C({"border-left-color":o.borderColor})},{default:i((()=>[I(e.$slots,"default",{},void 0,!0)])),_:3},8,["id","class","style"])])),_:3})}],["__scopeId","data-v-257e8068"]]),P=T({__name:"home-banner",props:{banners:{type:Array,default:()=>[]}},emits:["bannerClick"],setup:(e,{emit:l})=>(d,c)=>{const h=y,u=D,m=q;return t(),s(m,{class:"banner","indicator-color":"pink","indicator-dots":!0,autoplay:!0,interval:3e3,duration:1e3},{default:i((()=>[(t(!0),a(o,null,r(e.banners,((e,a)=>(t(),s(u,{key:a,onClick:t=>{return s=e.link,void l("bannerClick",s);var s}},{default:i((()=>[n(h,{class:"image",src:e.image,mode:"widthFix"},null,8,["src"])])),_:2},1032,["onClick"])))),128))])),_:1})}},[["__scopeId","data-v-cae12202"]]),R=T({__name:"home-recommend",props:{recommends:{type:Array,default:()=>[]}},emits:["recommend-item-click"],setup:(e,{emit:l})=>(h,m)=>{const g=y,f=u;return t(),s(f,{class:"recommend-wrapper"},{default:i((()=>[(t(!0),a(o,null,r(e.recommends,((e,a)=>(t(),s(f,{key:a,class:"recommend-item",onClick:t=>{return s=e.link,void l("recommend-item-click",s);var s}},{default:i((()=>[n(g,{class:"image",src:e.image,mode:"widthFix"},null,8,["src"]),n(f,{class:"title"},{default:i((()=>[d(c(e.title),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})}},[["__scopeId","data-v-feaf85be"]]);const J=T({},[["render",function(e,a){const o=y,r=u;return t(),s(r,{class:"popular"},{default:i((()=>[n(o,{class:"image",src:"/assets/recommend_bg-6119532a.jpg",mode:"widthFix"})])),_:1})}],["__scopeId","data-v-d01d01af"]]);const K=new class{request(e,t,s){return new Promise(((i,a)=>{H({url:"http://127.0.0.1:3007"+e,timeout:1e4,method:t,data:s,success:e=>{i(e.data)},fail:e=>{throw e}})}))}get(e,t){return this.request(e,"GET",t)}post(e,t){return this.request(e,"POST",t)}};const Q=["pop","new","sell"];function V(){let e={};return Q.forEach((t=>{e[t]={page:0,list:[]}})),e}const W=j("home",{state:()=>({banners:[],recommends:[],goodsList:V()}),getters:{},actions:{async fetchHomeMultiData(){const e=await K.get("/home/multidata");this.banners=e.data.banner.list,this.recommends=e.data.recommend.list},async fetchHomeData(e,t){const s=await function(e,t){return K.get("/home/data",{type:e,page:t})}(e,t);this.goodsList[e].list.push(...s.data.list),this.goodsList[e].page=t}}}),X={__name:"home",setup(l){const d=W(),{banners:c,recommends:h,goodsList:m}=S(d),g=e(0);L((()=>{d.fetchHomeMultiData(),d.fetchHomeData("pop",1),d.fetchHomeData("new",1),d.fetchHomeData("sell",1)})),M((()=>{d.fetchHomeData(Q[g.value],m.value[[Q[g.value]]].page+1)}));const f=e=>{E({url:"/pages/webview/webview?link="+e})},p=e=>{E({url:"/pages/webview/webview?link="+e})},_=e=>{g.value=e};return(e,l)=>{const d=A(F("tab-control"),z),b=A(F("grid-view-item"),N),w=A(F("uni-grid-item"),O),v=A(F("uni-grid"),U),k=u;return t(),s(k,{class:"home"},{default:i((()=>[n(P,{banners:$(c),onBannerClick:f},null,8,["banners"]),n(R,{recommends:$(h),onRecommendItemClick:p},null,8,["recommends"]),n(J),n(d,{titles:["流行","新款","精选"],onTabItemClick:_}),n(v,{column:2,square:!1,"show-border":!1,highlight:!1},{default:i((()=>[(t(!0),a(o,null,r($(m)[$(Q)[g.value]].list,((e,a)=>(t(),s(w,{key:e.iid},{default:i((()=>[n(b,{"goods-info":e},null,8,["goods-info"])])),_:2},1024)))),128))])),_:1})])),_:1})}}};export{X as default};
